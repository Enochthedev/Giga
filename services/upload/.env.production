# Production Environment Configuration for Upload Service
# High-load optimized settings for 1000+ concurrent uploads

# Server Configuration
NODE_ENV=production
PORT=3005
HOST=0.0.0.0

# Database Configuration - Production PostgreSQL
DATABASE_URL=postgresql://upload_user:upload_secure_password@postgres-upload:5432/upload_db?schema=public&connection_limit=50&pool_timeout=20&connect_timeout=10

# Redis Configuration - Production Redis Cluster
REDIS_URL=redis://redis-upload:6379/0
REDIS_CLUSTER_ENABLED=true
REDIS_CLUSTER_NODES=redis-upload-1:6379,redis-upload-2:6379,redis-upload-3:6379
REDIS_PASSWORD=redis_secure_password
REDIS_MAX_RETRIES=5
REDIS_RETRY_DELAY=1000
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000

# Connection Pool Configuration
DB_POOL_MIN=10
DB_POOL_MAX=50
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_ACQUIRE_TIMEOUT=60000
REDIS_POOL_MIN=5
REDIS_POOL_MAX=25

# Upload Configuration - High Performance
MAX_FILE_SIZE=104857600
MAX_FILES=50
MAX_CONCURRENT_UPLOADS=25
UPLOAD_TIMEOUT=300000
CHUNK_SIZE=1048576
STREAM_BUFFER_SIZE=65536

# Memory Management - Production Optimized
MEMORY_LIMIT_MB=2048
MEMORY_WARNING_THRESHOLD=0.8
MEMORY_CRITICAL_THRESHOLD=0.9
GC_INTERVAL=30000
BUFFER_POOL_SIZE=100

# Storage Configuration - Production S3/MinIO
STORAGE_PROVIDER=s3
STORAGE_BUCKET=upload-production
STORAGE_REGION=us-east-1
STORAGE_ENDPOINT=https://s3.amazonaws.com
AWS_ACCESS_KEY_ID=your_production_access_key
AWS_SECRET_ACCESS_KEY=your_production_secret_key
STORAGE_PUBLIC_URL=https://cdn.yourdomain.com

# CDN Configuration
CDN_ENABLED=true
CDN_BASE_URL=https://cdn.yourdomain.com
CDN_CACHE_TTL=31536000
CDN_PURGE_ENABLED=true

# Security Configuration
JWT_SECRET=your_super_secure_jwt_secret_key_here_minimum_32_chars
ENCRYPTION_KEY=your_32_character_encryption_key_here
CORS_ORIGIN=https://yourdomain.com,https://app.yourdomain.com
CORS_CREDENTIALS=true

# Processing Configuration - High Throughput
QUEUE_CONCURRENCY=20
QUEUE_MAX_JOBS=1000
QUEUE_RETRY_ATTEMPTS=3
QUEUE_RETRY_DELAY=5000
PROCESSING_TIMEOUT=600000

# Image Processing - Optimized
IMAGE_QUALITY=85
IMAGE_MAX_WIDTH=2048
IMAGE_MAX_HEIGHT=2048
THUMBNAIL_SIZES=150x150,300x300,600x600
WEBP_ENABLED=true
AVIF_ENABLED=true

# Video Processing
VIDEO_MAX_SIZE=524288000
VIDEO_FORMATS=mp4,webm
VIDEO_QUALITY=720p
VIDEO_BITRATE=2000k

# Monitoring and Logging
LOG_LEVEL=info
LOG_FORMAT=json
METRICS_ENABLED=true
HEALTH_CHECK_INTERVAL=30000
PERFORMANCE_MONITORING=true

# Rate Limiting (Backup - Gateway should handle primary rate limiting)
RATE_LIMIT_ENABLED=false
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX_REQUESTS=1000

# Cleanup and Retention
CLEANUP_ENABLED=true
CLEANUP_INTERVAL=3600000
TEMP_FILE_TTL=86400000
FAILED_UPLOAD_TTL=604800000

# GDPR and Compliance
GDPR_ENABLED=true
DATA_RETENTION_DAYS=2555
AUDIT_LOG_ENABLED=true
ENCRYPTION_AT_REST=true

# Performance Optimization
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6
KEEP_ALIVE_TIMEOUT=65000
HEADERS_TIMEOUT=66000
REQUEST_TIMEOUT=300000

# Worker Configuration
WORKER_CONCURRENCY=4
WORKER_MAX_JOBS=100
WORKER_RETRY_ATTEMPTS=3
WORKER_RETRY_DELAY=5000

# Cache Configuration
CACHE_TTL=3600
METADATA_CACHE_TTL=1800
FILE_CACHE_TTL=86400
CACHE_MAX_SIZE=1000

# External Service URLs
AUTH_SERVICE_URL=http://auth-service:3001
NOTIFICATION_SERVICE_URL=http://notification-service:3006
PAYMENT_SERVICE_URL=http://payment-service:3004

# Feature Flags
ASYNC_PROCESSING=true
STREAMING_UPLOADS=true
MEMORY_MONITORING=true
PERFORMANCE_PROFILING=true
ADVANCED_SECURITY=true

# Backup and Recovery
BACKUP_ENABLED=true
BACKUP_INTERVAL=86400000
BACKUP_RETENTION_DAYS=30
DISASTER_RECOVERY_ENABLED=true

# Load Balancing
LOAD_BALANCER_ENABLED=true
HEALTH_CHECK_PATH=/health
GRACEFUL_SHUTDOWN_TIMEOUT=30000

# SSL/TLS Configuration
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/upload-service.crt
SSL_KEY_PATH=/etc/ssl/private/upload-service.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Microservice Communication
SERVICE_DISCOVERY_ENABLED=true
SERVICE_REGISTRY_URL=http://consul:8500
SERVICE_NAME=upload-service
SERVICE_VERSION=1.0.0
SERVICE_TAGS=upload,file-management,production

# Alerting and Notifications
ALERT_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
ERROR_NOTIFICATION_ENABLED=true
PERFORMANCE_ALERT_ENABLED=true
DISK_SPACE_ALERT_THRESHOLD=0.9
MEMORY_ALERT_THRESHOLD=0.85

# Development and Debug (Disabled in Production)
DEBUG=false
VERBOSE_LOGGING=false
PROFILING_ENABLED=false
MOCK_EXTERNAL_SERVICES=false